(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e65c4d6"],{"5a62":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("PublicTitle",[s("div",{staticClass:"d4",attrs:{slot:"header"},slot:"header"},[t._v("修改密码")]),s("div",{staticClass:"d2",attrs:{slot:"footer"},slot:"footer"},[s("span",{staticClass:"click-span",staticStyle:{"padding-right":"15px","border-right":"1px solid #ccc"},on:{click:t.goLogin}},[t._v("登录")]),s("span",{staticClass:"click-span",staticStyle:{"padding-left":"15px"},on:{click:t.goRegister}},[t._v("注册")])]),s("div",{staticClass:"main",attrs:{slot:"main"},slot:"main"},[s("el-steps",{staticClass:"steps",attrs:{"align-center":"",active:t.active,"finish-status":"success"}},[s("el-step",{attrs:{title:"确认账号"}}),s("el-step",{attrs:{title:"修改密码"}}),s("el-step",{attrs:{title:"修改成功"}})],1),s("div",{staticClass:"d5"},[t.stepName?s("el-form",{ref:"form",staticClass:"form1",attrs:{model:t.form,"label-width":"60px","label-position":"right"}},[s("el-form-item",{attrs:{label:"账号:",prop:"username",rules:t.UserRules}},[s("el-input",{staticClass:"elinput",attrs:{placeholder:"输入账号"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),s("el-form-item",{attrs:{label:"验证码:",prop:"yzm",rules:t.YzmRules}},[s("el-input",{staticClass:"elinput",attrs:{placeholder:"输入邮箱"},model:{value:t.form.yzm,callback:function(e){t.$set(t.form,"yzm",e)},expression:"form.yzm"}},[t.show?s("el-button",{staticStyle:{width:"130px"},attrs:{slot:"append"},on:{click:t.emailYzm},slot:"append"},[t._v("获取验证码")]):t._e(),t.show?t._e():s("el-button",{staticStyle:{width:"130px"},attrs:{slot:"append"},slot:"append"},[t._v(t._s(t.count)+"后重新获取")])],1)],1),s("el-button",{staticClass:"mid1",attrs:{type:"primary"},on:{click:t.step1}},[t._v("下一步")])],1):t._e(),t.stepName2?s("el-form",{ref:"form2",staticClass:"form1",attrs:{model:t.form2,"label-width":"100px","label-position":"right"}},[s("el-form-item",{attrs:{label:"账号:"}},[s("span",{staticClass:"s2"},[t._v(" "+t._s(this.form2.username)+" ")])]),s("el-form-item",{attrs:{label:"旧密码:",prop:"oldPassword",rules:t.PassRules}},[s("el-input",{staticClass:"elinput",attrs:{placeholder:"输入旧密码",type:"password"},model:{value:t.form2.oldPassword,callback:function(e){t.$set(t.form2,"oldPassword",e)},expression:"form2.oldPassword"}})],1),s("el-form-item",{attrs:{label:"新密码:",prop:"newPassword",rules:t.PassRules}},[s("el-input",{staticClass:"elinput",attrs:{placeholder:"输入新密码",type:"password"},model:{value:t.form2.newPassword,callback:function(e){t.$set(t.form2,"newPassword",e)},expression:"form2.newPassword"}})],1),s("el-form-item",{attrs:{label:"确认密码:",prop:"newPassword2",rules:t.Pass2Rules}},[s("el-input",{staticClass:"elinput",attrs:{placeholder:"确认新密码",type:"password"},model:{value:t.form2.newPassword2,callback:function(e){t.$set(t.form2,"newPassword2",e)},expression:"form2.newPassword2"}})],1),s("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"mid1",attrs:{type:"primary"},on:{click:t.step2}},[t._v("确认修改")])],1):t._e(),t.stepName3?s("div",[s("div",{staticStyle:{"font-size":"30px","margin-bottom":"50px"}},[t._v("密码修改成功")]),s("el-button",{staticClass:"mid1",attrs:{type:"primary"},on:{click:t.goLogin}},[t._v("返回登录页面")])],1):t._e()],1)],1)])],1)},r=[],i=s("4aca"),l=s("cc96"),o={mixins:[i["a"]],components:{PublicTitle:l["a"]},data:function(){var t=this,e=function(e,s,a){""===s?a(new Error("请再次输入密码")):s!==t.form2.newPassword?a(new Error("两次输入密码不一致!")):a()};return{fullscreenLoading:!1,active:0,count:"",timer:null,show:!0,form:{username:"",yzm:""},form2:{oldPassword:"",newPassword:"",newPassword2:""},Pass2Rules:[{validator:e,trigger:"blur"}]}},computed:{dheight:function(){return{height:document.documentElement.clientHeight+"px"}},stepName:function(){return 0==this.active},stepName2:function(){return 1==this.active},stepName3:function(){return 2==this.active}},methods:{step1:function(){var t=this;this.form2.username=this.form.username,this.$refs.form.validate((function(e){if(!e)return!1;t.$utils.http.call(t,{url:"/?s=App.Email.VerifyCaptcha",parameter:{address:t.form.username,captcha:t.form.yzm},success:function(e){var s=e.data.data.err_code,a=e.data.data.err_msg;0==s?(t.active++,t.form2.username=t.form.username):t.$message.error(a)}})}))},step2:function(){var t=this;this.$refs.form2.validate((function(e){if(!e)return!1;t.fullscreenLoading=!0,t.$utils.http.call(t,{url:"/?s=App.User.Login",parameter:{username:t.form2.username,password:t.$md5(t.form2.oldPassword)},success:function(e){var s=e.data.data.err_code,a=e.data.data.err_msg;if(0!=s)return t.$message.error(a);t.changePassword()}})}))},changePassword:function(){var t=this;this.$utils.http.call(this,{url:"/?s=App.User.AlterPassword",parameter:{username:this.form.username,old_password:this.$md5(this.form2.oldPassword),new_password:this.$md5(this.form2.newPassword)},success:function(e){var s=e.data.data.err_code,a=e.data.data.err_msg;if(0!=s)return t.fullscreenLoading=!1,t.$message.error(a);t.fullscreenLoading=!1,t.active++}})},emailYzm:function(){var t=this,e=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(!e.test(this.form.username))return this.$refs.form.validateField("username");this.$utils.http.call(this,{url:"/?s=App.Email.SendCaptcha",parameter:{address:this.form.username},success:function(t){}});var s=60;this.timer||(this.count=s,this.show=!1,this.timer=setInterval((function(){t.count>0&&t.count<=s?t.count--:(t.show=!0,clearInterval(t.timer),t.timer=null)}),1e3))}}},n=o,c=(s("dc39"),s("2877")),m=Object(c["a"])(n,a,r,!1,null,"779db3f9",null);e["default"]=m.exports},"7cc1":function(t,e,s){},cc96:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{style:t.dheight},[a("el-header",{attrs:{height:"100px"}},[a("div",{staticClass:"d1"},[a("el-row",[a("el-col",{attrs:{span:20}},[a("div",{staticClass:"d3"},[a("img",{staticStyle:{width:"100px"},attrs:{src:s("17be"),alt:""}}),t._t("header")],2)]),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"d2"},[t._t("footer")],2)])],1)],1)]),a("el-main",[t._t("main")],2)],1)},r=[],i={data:function(){return{}},computed:{dheight:function(){return{height:document.documentElement.clientHeight+"px"}}}},l=i,o=s("2877"),n=Object(o["a"])(l,a,r,!1,null,"20fe63d0",null);e["a"]=n.exports},dc39:function(t,e,s){"use strict";var a=s("7cc1"),r=s.n(a);r.a}}]);
//# sourceMappingURL=chunk-3e65c4d6.3ede3d00.js.map