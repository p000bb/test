(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0981ba98"],{"129f":function(t,a){t.exports=Object.is||function(t,a){return t===a?0!==t||1/t===1/a:t!=t&&a!=a}},2866:function(t,a,e){"use strict";var s=e("ffe7"),i=e.n(s);i.a},"841c":function(t,a,e){"use strict";var s=e("d784"),i=e("825a"),n=e("1d80"),r=e("129f"),o=e("14c3");s("search",1,(function(t,a,e){return[function(a){var e=n(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,e):new RegExp(a)[t](String(e))},function(t){var s=e(a,t,this);if(s.done)return s.value;var n=i(t),c=String(this),l=n.lastIndex;r(l,0)||(n.lastIndex=0);var m=o(n,c);return r(n.lastIndex,l)||(n.lastIndex=l),null===m?-1:m.index}]}))},"857a":function(t,a,e){var s=e("1d80"),i=/"/g;t.exports=function(t,a,e,n){var r=String(s(t)),o="<"+a;return""!==e&&(o+=" "+e+'="'+String(n).replace(i,"&quot;")+'"'),o+">"+r+"</"+a+">"}},a15b:function(t,a,e){"use strict";var s=e("23e7"),i=e("44ad"),n=e("fc6a"),r=e("a640"),o=[].join,c=i!=Object,l=r("join",",");s({target:"Array",proto:!0,forced:c||!l},{join:function(t){return o.call(n(this),void 0===t?",":t)}})},af03:function(t,a,e){var s=e("d039");t.exports=function(t){return s((function(){var a=""[t]('"');return a!==a.toLowerCase()||a.split('"').length>3}))}},b0c0:function(t,a,e){var s=e("83ab"),i=e("9bf2").f,n=Function.prototype,r=n.toString,o=/^\s*function ([^ (]*)/,c="name";!s||c in n||i(n,c,{configurable:!0,get:function(){try{return r.call(this).match(o)[1]}catch(t){return""}}})},c90f:function(t,a,e){"use strict";e.r(a);var s,i=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[s("el-container",{style:t.dheight},[s("el-header",{attrs:{height:"30px"}},[s("div",{staticClass:"d1"},[s("el-row",[s("el-col",{attrs:{span:20}}),s("el-col",{attrs:{span:4}},[s("div",{staticClass:"d2"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLogin,expression:"!isLogin"}]},[s("span",{staticClass:"click-span",staticStyle:{"padding-right":"15px","border-right":"1px solid #ccc"},on:{click:t.goLogin}},[t._v("登录")]),s("span",{staticClass:"click-span",staticStyle:{"padding-left":"15px","margin-right":"15px"},on:{click:t.goRegister}},[t._v("注册")])]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isLogin,expression:"isLogin"}]},[s("el-dropdown",{attrs:{"hide-timeout":300},on:{command:t.handleCommand}},[s("span",[t._v("欢迎:"+t._s(t.username||t.loginName)),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",{attrs:{command:"userinfo"}},[t._v("个人信息")]),s("el-dropdown-item",{attrs:{command:"outLogin"}},[t._v("退出登录")])],1)],1)],1)])])],1)],1)]),s("el-main",[s("div",{staticStyle:{width:"90%",margin:"auto"}},[s("div",{staticClass:"main-d1"},[s("el-row",[s("el-col",{attrs:{span:6}},[s("img",{staticStyle:{width:"180px","margin-top":"20px"},attrs:{src:e("17be"),alt:""}})]),s("el-col",{attrs:{span:18}},[s("el-input",{staticStyle:{"line-height":"200px",width:"50%",float:"left"},attrs:{placeholder:"请输入电影id进行搜索"},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.search(t.movieId)}},model:{value:t.movieId,callback:function(a){t.movieId=a},expression:"movieId"}})],1)],1)],1),s("div",{staticClass:"mian-d2"},[s("div",[s("el-row",[s("el-col",{attrs:{span:16}},[s("h1",{staticStyle:{margin:"0px","text-align":"left"}},[t._v(t._s(t.searchForm.title)+" "+t._s(t.searchForm.original_title)+" ("+t._s(t.searchForm.year)+")")]),s("div",{staticStyle:{display:"flex","margin-top":"10px"}},[s("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[s("el-image",{staticStyle:{width:"135px"},attrs:{slot:"reference",src:t.mImg},slot:"reference"}),s("img",{attrs:{src:t.mImg,width:"270px"}})],1),s("div",[s("span",{staticClass:"search_span",staticStyle:{margin:"0 0 0 10px"}},[t._v("导演:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.directors))])]),s("span",{staticClass:"search_span"},[t._v("编剧:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.writers))])]),s("span",{staticClass:"search_span"},[t._v("主演:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.actor))])]),s("span",{staticClass:"search_span"},[t._v("类型:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.genres))])]),s("span",{staticClass:"search_span"},[t._v("制片国家/地区:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.countries))])]),s("span",{staticClass:"search_span"},[t._v("语言:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.languages))])]),s("span",{staticClass:"search_span"},[t._v("上映日期:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.pubdates))])]),s("span",{staticClass:"search_span"},[t._v("片长:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.durations))])]),s("span",{staticClass:"search_span"},[t._v("电影id:"),s("span",{staticClass:"search_span2"},[t._v(t._s(t.searchForm.id))])])])],1),s("div",{staticClass:"main-div"},[s("h3",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.searchForm.title)+"的剧情简介")]),s("div",{staticStyle:{"text-align":"left","font-size":"15px"}},[t._v(t._s(t.searchForm.summary))])]),s("div",{staticClass:"main-div"},[s("h3",{staticStyle:{"text-align":"left"}},[t._v(t._s(t.searchForm.title)+"的演职员")]),s("div",{staticStyle:{"text-align":"left","font-size":"15px"}},t._l(t.actorName.length,(function(a,e){return s("div",{key:a,staticClass:"item_a"},[s("el-card",{attrs:{"body-style":{padding:"0px"}}},[s("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[s("el-image",{staticStyle:{"max-width":"115px"},attrs:{slot:"reference",src:t.actorsImg[e]||t.defaultImg,alt:"找不到图片"},slot:"reference"}),s("img",{attrs:{src:t.actorsImg[e]||t.defaultImg,alt:"找不到图片"}})],1),s("span",{staticClass:"hidden_span",staticStyle:{"font-size":"12px",padding:"10px"},attrs:{title:t.actorName[e]}},[t._v(t._s(t.actorName[e]||"暂无"))])],1)],1)})),0)]),s("div",{staticClass:"main-div"},[s("h3",{staticStyle:{"text-align":"left"}},[t._v(" "+t._s(t.searchForm.title)+"的热门影评 "),s("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.writerComment}},[t._v("我要写影评")])],1),s("el-tabs",{on:{"tab-click":t.handleClick2},model:{value:t.activeName1,callback:function(a){t.activeName1=a},expression:"activeName1"}},[s("el-tab-pane",{attrs:{label:"豆瓣影评",name:"douban"}},t._l(t.comment.length,(function(a,e){return s("div",[s("div",{class:t.divNum(e)},[s("h4",{staticClass:"h4"},[s("img",{staticClass:"comment_img",attrs:{src:t.comment[e].author.avatar||t.defaultImg,alt:"找不到图片"}}),s("span",{staticStyle:{"line-height":"48px",margin:"0 10px 0 10px"}},[t._v(t._s(t.comment[e].author.name))]),s("span",{staticStyle:{"line-height":"48px"}},[s("span",{staticStyle:{color:"#aaa"}},[t._v("评价")]),s("el-rate",{attrs:{disabled:"","text-color":"#ff9900","disabled-void-color":"#88888C"},model:{value:t.comment[e].rating.value,callback:function(a){t.$set(t.comment[e].rating,"value",a)},expression:"comment[index].rating.value"}}),s("span",{staticStyle:{color:"#aaa","margin-left":"15px"}},[t._v(t._s(t.comment[e].created_at))])],1)]),s("p",{staticClass:"comment_p"},[t._v(" "+t._s(t.comment[e].content)+" ")])])])})),0),s("el-tab-pane",{attrs:{label:"小熊影评",name:"xiaoxiong"}},[0==t.xxComment.length?s("div",[s("h3",[t._v("暂无评论")])]):t._e(),t._l(t.xxComment.length,(function(a,e){return 0!=t.xxComment.length?s("div",[s("div",{class:t.divNum(e)},[s("h4",{staticClass:"h4"},[s("img",{staticClass:"comment_img",attrs:{src:t.xxComment[e].cover||t.defaultImg,alt:"找不到图片"}}),s("span",{staticStyle:{"line-height":"48px",margin:"0 10px 0 10px"}},[t._v(t._s(t.xxComment[e].username))]),s("span",{staticStyle:{"line-height":"48px"}},[s("span",{staticStyle:{color:"#aaa"}},[t._v("评价")]),s("el-rate",{attrs:{disabled:"","text-color":"#ff9900","disabled-void-color":"#88888C"},model:{value:t.xxComment[e].rank,callback:function(a){t.$set(t.xxComment[e],"rank",a)},expression:"xxComment[index].rank"}}),s("span",{staticStyle:{color:"#aaa","margin-left":"15px"}},[t._v(t._s(t.xxComment[e].add_time))])],1)]),s("p",{staticClass:"comment_p"},[t._v(" "+t._s(t.xxComment[e].comments)+" ")])])]):t._e()}))],2)],1)],1)]),s("el-col",{attrs:{span:8}},[s("div",{staticStyle:{"margin-left":"60px","margin-bottom":"100px"}},[s("div",{staticStyle:{display:"flex"}},[t._v("豆瓣评分")]),s("div",{staticStyle:{margin:"15px 10px 0 0"}},[s("span",{staticClass:"rank_span"},[t._v(" "+t._s(t.average)+" ")]),s("span",[s("el-rate",{attrs:{disabled:"","text-color":"#ff9900","disabled-void-color":"#88888C"},model:{value:t.rank,callback:function(a){t.rank=a},expression:"rank"}})],1)])]),s("div",{staticStyle:{"margin-left":"60px","margin-bottom":"100px"}},[s("div",{staticStyle:{display:"flex"}},[t._v("小熊评分")]),s("div",{staticStyle:{margin:"15px 10px 0 0"}},[s("span",{staticClass:"rank_span"},[t._v(" "+t._s(2*t.xxRank)+" ")]),s("span",[s("el-rate",{attrs:{disabled:"","text-color":"#ff9900","disabled-void-color":"#88888C"},model:{value:t.xxRank,callback:function(a){t.xxRank=a},expression:"xxRank"}})],1)])]),s("div",{staticStyle:{"margin-left":"60px"}},[t.mVideo.length>0?s("div",{staticStyle:{display:"flex"}},[t._v("在哪能看")]):t._e(),s("div",{staticStyle:{margin:"15px 10px 0 0"}},t._l(t.mVideo.length,(function(a,e){return s("h5",{staticStyle:{"margin-top":"0px",height:"30px",display:"flex"}},[s("img",{attrs:{src:t.mVideo[e].source.pic,width:"30px"}}),s("a",{staticClass:"a_img",attrs:{href:t.mVideo[e].sample_link,target:"_blank"}},[t._v(t._s(t.mVideo[e].source.name))])])})),0)])])],1)],1)])])])],1),s("el-dialog",{attrs:{title:"我要评论",visible:t.dialogVisible,width:"60%"},on:{"update:visible":function(a){t.dialogVisible=a}}},[s("div",[s("div",{staticStyle:{"margin-bottom":"15px"}},[s("span",[t._v("给个评分吧!")]),s("el-rate",{model:{value:t.dialog.rank,callback:function(a){t.$set(t.dialog,"rank",a)},expression:"dialog.rank"}})],1),s("el-input",{attrs:{type:"textarea",rows:5,placeholder:"请输入内容",maxlength:300,"show-word-limit":""},model:{value:t.dialog.textarea,callback:function(a){t.$set(t.dialog,"textarea",a)},expression:"dialog.textarea"}})],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(a){t.dialogVisible=!1}}},[t._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.submitComment}},[t._v("确 定")])],1)])],1)},n=[],r=(e("4160"),e("a15b"),e("b0c0"),e("ac1f"),e("5319"),e("841c"),e("c96a"),e("159b"),e("ade3")),o=e("4aca"),c={mixins:[o["a"]],data:function(){return{loading:!1,activeName1:"douban",taburl:"/v2/movie/in_theaters?apikey=0df993c66c0c636e29ecbb5344252a4a",loginName:"",movieId:"",commentId:"",searchForm:[],durations:"",genres:"",languages:"",countries:"",pubdates:"",average:0,xxComment:"",dialogVisible:!1,xxRank:0,username:"",dialog:{rank:0,textarea:""},apikey:"?apikey=0df993c66c0c636e29ecbb5344252a4a",douban:"https://api.douban.com",defaultImg:"https://img1.doubanio.com/icon/user_normal.jpg"}},computed:(s={dheight:function(){return{height:document.documentElement.clientHeight+"px"}},isLogin:function(){return!(!sessionStorage.getItem("username")||!sessionStorage.getItem("token"))},rank:function(){return this.average?this.average/2:0},mImg:function(){var t="";return""==this.searchForm?t:this.searchForm.images.small},actorsImg:function(){var t=[];return""==this.searchForm?t:(this.searchForm.casts.forEach((function(a,e,s){t.push(a.avatars.small)})),this.searchForm.casts?t.join("/"):"")},directors:function(){var t=[];return""==this.searchForm?t:(this.searchForm.directors.forEach((function(a,e,s){t.push(a.name)})),this.searchForm.directors?t.join("/"):"")},actor:function(){var t=[];return""==this.searchForm?t:(this.searchForm.casts.forEach((function(a,e,s){t.push(a.name)})),this.searchForm.casts?t.join("/"):"")},writers:function(){var t=[];return""==this.searchForm?t:(this.searchForm.writers.forEach((function(a,e,s){t.push(a.name)})),this.searchForm.writers?t.join("/"):"")}},Object(r["a"])(s,"actorsImg",(function(){var t=[];return""==this.searchForm?t:(this.searchForm.casts.forEach((function(a,e,s){t.push(a.avatars?a.avatars.small:"")})),this.searchForm.casts?t:"")})),Object(r["a"])(s,"actorName",(function(){var t=[];return""==this.searchForm?t:(this.searchForm.casts.forEach((function(a,e,s){t.push(a.name)})),this.searchForm.casts?t:"")})),Object(r["a"])(s,"comment",(function(){var t=[];return""==this.searchForm?t:(this.searchForm.popular_comments.forEach((function(a,e,s){t.push(a)})),this.searchForm.popular_comments?t:"")})),Object(r["a"])(s,"mVideo",(function(){var t=[];return""==this.searchForm?t:(this.searchForm.videos.forEach((function(a,e,s){t.push(a)})),this.searchForm.videos?t:"")})),s),created:function(){this.movieId=this.$route.query.id,this.loginName=sessionStorage.getItem("username"),this.username=sessionStorage.getItem("info")?JSON.parse(sessionStorage.getItem("info")).yesapi_nickname:"",this.search(this.$route.query.id),this.getRank()},methods:{divNum:function(t){return 0!=t?"comment_div":"comment_div1"},search:function(t){var a=this;this.loading=!0,this.$http.jsonp(this.douban+"/v2/movie/subject/"+t+this.apikey).then((function(t){a.searchForm=t.data,a.durations=a.searchForm.durations.join("/"),a.genres=a.searchForm.genres.join("/"),a.languages=a.searchForm.languages.join("/"),a.countries=a.searchForm.countries.join("/"),a.pubdates=a.searchForm.pubdates.join("/"),a.average=a.searchForm.rating.average,a.commentId=a.searchForm.id,a.loading=!1})).catch((function(t){a.$message.error("对不起该电影id不存在"),a.$router.push("/index")}))},handleCommand:function(t){"userinfo"==t?this.userinfo():"outLogin"==t&&this.outLogin()},outLogin:function(){window.sessionStorage.removeItem("token"),window.sessionStorage.removeItem("username"),this.$router.replace("/index"),window.location.reload()},handleClick2:function(t,a){"douban"===t.name||"xiaoxiong"===t.name&&this.getxxComment()},getxxComment:function(){var t=this;this.$utils.http.call(this,{url:"/?s=App.Table.GetMoreDataByMoreField",parameter:{model_name:"yesapi_douban_movies",field_name_list:"douban_id",field_value_list:this.commentId||this.movieId},success:function(a){t.xxComment=a.data.data.items,t.getRank()}})},getRank:function(){var t=this;this.$utils.http.call(this,{url:"/?s=App.Table.FreeAggregation",parameter:{model_name:"yesapi_douban_movies",op_funs:"AVG",op_fields:"rank",where:'[["douban_id", "=", "'.concat(this.commentId||this.movieId,'"]]')},success:function(a){var e=a.data.data.report.AVG_rank;0==e.substring(2,3)?t.xxRank=a.data.data.report.AVG_rank.substring(0,1)-0:t.xxRank=a.data.data.report.AVG_rank.substring(0,3)-0}})},writerComment:function(){this.dialog.rank=0,this.dialog.textarea="",sessionStorage.getItem("token")?this.dialogVisible=!0:(this.$message.error("对不起请先登录"),this.$router.replace("/login"))},submitComment:function(){var t=this;if(""==this.dialog.textarea||0==this.dialog.rank)return this.$message.error("请填写评分和内容");var a={movieName:this.searchForm.title,cover:JSON.parse(sessionStorage.getItem("info")).yesapi_avatar,douban_id:this.commentId,rank:this.dialog.rank,comments:this.dialog.textarea,username:this.username,creatTime:new Date};this.$utils.http.call(this,{url:"/?s=App.Table.Create",parameter:{model_name:"yesapi_douban_movies",data:JSON.stringify(a)},success:function(a){t.getxxComment(),t.dialogVisible=!1,t.dialog.rank=0,t.dialog.textarea=""}})}}},l=c,m=(e("2866"),e("2877")),d=Object(m["a"])(l,i,n,!1,null,"df813f1e",null);a["default"]=d.exports},c96a:function(t,a,e){"use strict";var s=e("23e7"),i=e("857a"),n=e("af03");s({target:"String",proto:!0,forced:n("small")},{small:function(){return i(this,"small","","")}})},ffe7:function(t,a,e){}}]);
//# sourceMappingURL=chunk-0981ba98.736d3b1b.js.map